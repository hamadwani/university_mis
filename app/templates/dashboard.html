{% extends 'base.html' %}
{% block content %}

<h2 class="page-title mb-4">University Dashboard</h2>

<!-- STAT CARDS -->
<div class="row g-4">

    <!-- TOTAL STUDENTS -->
    <div class="col-md-3">
        <a href="{{ url_for('main.students') }}" class="card-link">
            <div class="stat-card gradient-blue">
                <h3>{{ total_students }}</h3>
                <p>Total Students</p>
            </div>
        </a>
    </div>

    <!-- DEPARTMENTS -->
    <div class="col-md-3">
        <a href="{{ url_for('main.departments') }}" class="card-link">
            <div class="stat-card gradient-gold">
                <h3>{{ departments|length }}</h3>
                <p>Departments</p>
            </div>
        </a>
    </div>

    <!-- ENROLLMENTS -->
    <div class="col-md-3">
        <a href="{{ url_for('main.enrollment') }}" class="card-link">
            <div class="stat-card gradient-purple">
                <h3>{{ enrollments|length }}</h3>
                <p>Recent Enrollments</p>
            </div>
        </a>
    </div>

    <!-- STAFF -->
    <div class="col-md-3">
        <a href="{{ url_for('main.staff_list') }}" class="card-link">
            <div class="stat-card gradient-red">
                <h3>{{ staff|length }}</h3>
                <p>Total Staff</p>
            </div>
        </a>
    </div>

</div>

<hr class="my-4">

<!-- Latest Enrollment Table -->
<h4>Latest Enrollments</h4>

<table class="table table-dark table-striped table-hover">
    <thead>
        <tr>
            <th>#</th>
            <th>Student</th>
            <th>Programme</th>
            <th>Year</th>
            <th>Mode</th>
            <th>Total</th>
        </tr>
    </thead>

    <tbody>
        {% for e in enrollments %}
        <tr>
            <td>{{ loop.index }}</td>

            <td>
                {% if e.student %}
                    <a href="{{ url_for('main.student_profile', id=e.student.id) }}" class="dashboard-link">
                        {{ e.student.roll_no }} - {{ e.student.name }}
                    </a>
                {% else %}
                    <span class="text-muted">-</span>
                {% endif %}
            </td>

            <td>{{ e.programme }}</td>
            <td>{{ e.year }}</td>
            <td>{{ e.mode }}</td>

            <td>
                {{
                    (e.general_male or 0) +
                    (e.general_female or 0) +
                    (e.ews_male or 0) +
                    (e.ews_female or 0) +
                    (e.sc_male or 0) +
                    (e.sc_female or 0) +
                    (e.st_male or 0) +
                    (e.st_female or 0) +
                    (e.obc_male or 0) +
                    (e.obc_female or 0) +
                    (e.trans_gender or 0)
                }}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}
